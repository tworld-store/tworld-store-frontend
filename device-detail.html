<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸°ê¸° ìƒì„¸ - SKT íœ´ëŒ€í° ì‡¼í•‘ëª°</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        /* ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* ìƒ‰ìƒ ì„ íƒ ë¼ë””ì˜¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .color-radio {
            display: none;
        }
        .color-radio + label {
            cursor: pointer;
            transition: all 0.2s;
        }
        .color-radio:checked + label {
            border: 3px solid #2563eb;
            transform: scale(1.1);
        }
        
        /* ì˜µì…˜ ì„ íƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .option-radio {
            display: none;
        }
        .option-radio + label {
            cursor: pointer;
            border: 2px solid #e5e7eb;
            transition: all 0.2s;
        }
        .option-radio:checked + label {
            border-color: #2563eb;
            background-color: #eff6ff;
        }
        .option-radio:hover + label {
            border-color: #93c5fd;
        }
        
        /* Sticky ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ */
        .sticky-gallery {
            position: sticky;
            top: 100px;
            height: fit-content;
        }
        
        /* ëª¨ë°”ì¼ í•˜ë‹¨ ê³ ì • ë°” */
        .mobile-bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 50;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        
        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2563eb;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ê°€ê²© ë°•ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
        .price-box {
            transition: all 0.3s ease;
        }
        .price-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .sticky-gallery {
                position: relative;
                top: 0;
            }
            body {
                padding-bottom: 80px;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- ============================================ -->
    <!-- í—¤ë” (ê³ ì •) -->
    <!-- ============================================ -->
    <header class="sticky top-0 z-50 bg-white shadow-md">
        <nav class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <!-- ë¡œê³  -->
                <a href="index.html" class="flex items-center space-x-2">
                    <span class="text-2xl font-bold text-blue-600">T</span>
                    <span class="text-xl font-semibold">World Store</span>
                </a>
                
                <!-- ë„¤ë¹„ê²Œì´ì…˜ (ë°ìŠ¤í¬í†±) -->
                <div class="hidden md:flex items-center space-x-6">
                    <a href="devices.html" class="hover:text-blue-600 transition">ê¸°ê¸°</a>
                    <a href="plans.html" class="hover:text-blue-600 transition">ìš”ê¸ˆì œ</a>
                    <a href="calculator.html" class="hover:text-blue-600 transition">ê°€ê²©ê³„ì‚°</a>
                    <a href="contact.html" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">ìƒë‹´ì‹ ì²­</a>
                </div>
                
                <!-- ëª¨ë°”ì¼ ë©”ë‰´ ë²„íŠ¼ -->
                <button class="md:hidden" onclick="toggleMobileMenu()">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </nav>
    </header>

    <!-- ============================================ -->
    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <!-- ============================================ -->
    <main class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- ============================================ -->
            <!-- ì¢Œì¸¡: ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ (Sticky) -->
            <!-- ============================================ -->
            <div class="sticky-gallery">
                <!-- ë©”ì¸ ì´ë¯¸ì§€ -->
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <img id="main-image" 
                         src="https://via.placeholder.com/600x600" 
                         alt="ê¸°ê¸° ì´ë¯¸ì§€" 
                         class="w-full h-auto">
                </div>
                
                <!-- ì¸ë„¤ì¼ ë¦¬ìŠ¤íŠ¸ -->
                <div class="flex space-x-2 mt-4 overflow-x-auto">
                    <img src="https://via.placeholder.com/100" 
                         class="w-20 h-20 rounded-lg cursor-pointer border-2 border-blue-600"
                         onclick="changeMainImage(this.src)">
                    <img src="https://via.placeholder.com/100" 
                         class="w-20 h-20 rounded-lg cursor-pointer border-2 border-gray-300"
                         onclick="changeMainImage(this.src)">
                    <img src="https://via.placeholder.com/100" 
                         class="w-20 h-20 rounded-lg cursor-pointer border-2 border-gray-300"
                         onclick="changeMainImage(this.src)">
                </div>
                
                <!-- ìƒí’ˆ ì„¤ëª… ì´ë¯¸ì§€ (ê¸´ ì´ë¯¸ì§€) -->
                <div class="mt-8 bg-white rounded-xl shadow-lg overflow-hidden">
                    <img id="detail-image" 
                         src="https://via.placeholder.com/600x1200" 
                         alt="ìƒí’ˆ ìƒì„¸" 
                         class="w-full h-auto">
                </div>
            </div>

            <!-- ============================================ -->
            <!-- ìš°ì¸¡: ì˜µì…˜ ì„ íƒ ì˜ì—­ -->
            <!-- ============================================ -->
            <div class="space-y-6">
                
                <!-- ì œí’ˆëª… ë° ê¸°ë³¸ ì •ë³´ -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h1 id="device-model" class="text-3xl font-bold mb-2">ê°¤ëŸ­ì‹œ S24</h1>
                    <p id="device-brand" class="text-gray-600 mb-4">ì‚¼ì„±ì „ì</p>
                    <div class="flex items-baseline space-x-2">
                        <span class="text-gray-500">ì¶œê³ ê°€</span>
                        <span id="factory-price" class="text-3xl font-bold text-blue-600">1,200,000ì›</span>
                    </div>
                </div>

                <!-- 1. ìƒ‰ìƒ ì„ íƒ -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold mb-4">ìƒ‰ìƒ ì„ íƒ</h3>
                    <div id="color-options" class="flex flex-wrap gap-3">
                        <!-- ìƒ‰ìƒ ì˜µì…˜ ë™ì  ìƒì„± -->
                        <div>
                            <input type="radio" id="color-black" name="product_color" value="BLACK" class="color-radio" checked>
                            <label for="color-black" class="flex items-center justify-center w-16 h-16 rounded-full border-2 border-gray-300">
                                <span class="w-12 h-12 rounded-full" style="background-color: #000000;"></span>
                            </label>
                            <p class="text-center text-xs mt-1">íŒ¬í…€ë¸”ë™</p>
                        </div>
                        
                        <div>
                            <input type="radio" id="color-white" name="product_color" value="WHITE" class="color-radio">
                            <label for="color-white" class="flex items-center justify-center w-16 h-16 rounded-full border-2 border-gray-300">
                                <span class="w-12 h-12 rounded-full" style="background-color: #FFFFFF; border: 1px solid #e5e7eb;"></span>
                            </label>
                            <p class="text-center text-xs mt-1">í™”ì´íŠ¸</p>
                        </div>
                    </div>
                </div>

                <!-- 2. ìš©ëŸ‰ ì„ íƒ -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold mb-4">ìš©ëŸ‰ ì„ íƒ</h3>
                    <div id="capacity-options" class="grid grid-cols-2 gap-3">
                        <div>
                            <input type="radio" id="cap-256" name="type_capacity" value="256" class="option-radio" checked>
                            <label for="cap-256" class="block p-4 rounded-lg text-center font-semibold">
                                256GB
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="cap-512" name="type_capacity" value="512" class="option-radio">
                            <label for="cap-512" class="block p-4 rounded-lg text-center font-semibold">
                                512GB
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 3. ê°€ì…ìœ í˜• ì„ íƒ -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold mb-4">ê°€ì…ìœ í˜• ì„ íƒ</h3>
                    <div class="grid grid-cols-3 gap-3">
                        <div>
                            <input type="radio" id="join-change" name="type_subscription" value="ê¸°ê¸°ë³€ê²½" class="option-radio" checked>
                            <label for="join-change" class="block p-4 rounded-lg text-center font-semibold">
                                <div class="text-2xl mb-1">ğŸ”„</div>
                                ê¸°ê¸°ë³€ê²½
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="join-port" name="type_subscription" value="ë²ˆí˜¸ì´ë™" class="option-radio">
                            <label for="join-port" class="block p-4 rounded-lg text-center font-semibold">
                                <div class="text-2xl mb-1">ğŸ“±</div>
                                ë²ˆí˜¸ì´ë™
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="join-new" name="type_subscription" value="ì‹ ê·œê°€ì…" class="option-radio">
                            <label for="join-new" class="block p-4 rounded-lg text-center font-semibold">
                                <div class="text-2xl mb-1">âœ¨</div>
                                ì‹ ê·œê°€ì…
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 4. ìš”ê¸ˆì œ ì„ íƒ (íŒì—…ìœ¼ë¡œ ì—´ê¸°) -->
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-lg font-bold mb-4">ìš”ê¸ˆì œ ì„ íƒ</h3>
                        
                    <!-- â˜… ì„ íƒëœ ìš”ê¸ˆì œ ì •ë³´ í‘œì‹œ (ì²˜ìŒì—” ìˆ¨ê¹€) â˜… -->
                    <div id="selected-plan-info" class="mb-3 hidden">
                        <div class="p-3 bg-blue-50 rounded-lg border border-blue-200">
                            <div id="selected-plan-name" class="font-bold text-lg text-gray-900"></div>
                            <div id="selected-plan-price" class="text-sm text-blue-600 mt-1"></div>
                        </div>
                    </div>
    
                    <!-- ì„ íƒ ë²„íŠ¼ -->
                    <button onclick="openPlanModal()" class="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-600 transition">
                        <div id="selected-plan-display" class="text-gray-500">
                            ìš”ê¸ˆì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš” â†’
                        </div>
                    </button>
                </div>

                <!-- 5. í• ë¶€ê¸°ê°„ ì„ íƒ -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold mb-4">í• ë¶€ê¸°ê°„ ì„ íƒ</h3>
                    <div class="grid grid-cols-4 gap-3">
                        <div>
                            <input type="radio" id="period-0" name="type_period" value="0" class="option-radio">
                            <label for="period-0" class="block p-4 rounded-lg text-center font-semibold">
                                ì¼ì‹œë¶ˆ
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="period-12" name="type_period" value="12" class="option-radio">
                            <label for="period-12" class="block p-4 rounded-lg text-center font-semibold">
                                12ê°œì›”
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="period-24" name="type_period" value="24" class="option-radio" checked>
                            <label for="period-24" class="block p-4 rounded-lg text-center font-semibold">
                                24ê°œì›”
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="period-36" name="type_period" value="36" class="option-radio">
                            <label for="period-36" class="block p-4 rounded-lg text-center font-semibold">
                                36ê°œì›”
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 6. â˜… í• ì¸ë°©ë²• ì„ íƒ (ì§€ì›ê¸ˆì•½ì • vs ì„ íƒì•½ì •) â˜… -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold mb-4">í• ì¸ë°©ë²• ì„ íƒ</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <input type="radio" id="discount-phone" name="type_discount" value="phone" class="option-radio" checked>
                            <label for="discount-phone" class="block p-4 rounded-lg text-center">
                                <div class="font-bold text-lg mb-1">ì§€ì›ê¸ˆì•½ì •</div>
                                <div class="text-sm text-gray-600">íœ´ëŒ€í° ê°€ê²© í• ì¸</div>
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="discount-charge" name="type_discount" value="charge" class="option-radio">
                            <label for="discount-charge" class="block p-4 rounded-lg text-center">
                                <div class="font-bold text-lg mb-1">ì„ íƒì•½ì •</div>
                                <div class="text-sm text-gray-600">ìš”ê¸ˆ 25% í• ì¸</div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 7. ì¸í„°ë„·+TV ì„ íƒ -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold mb-4">ì¸í„°ë„·+TV ê²°í•©</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <input type="radio" id="other-no" name="type_other" value="N" class="option-radio" checked>
                            <label for="other-no" class="block p-4 rounded-lg text-center font-semibold">
                                ì„ íƒ ì•ˆí•¨
                            </label>
                        </div>
                        
                        <div>
                            <input type="radio" id="other-yes" name="type_other" value="Y" class="option-radio">
                            <label for="other-yes" class="block p-4 rounded-lg text-center font-semibold">
                                ê²°í•© ì‹ ì²­
                            </label>
                        </div>
                    </div>
                </div>

                <!-- ============================================ -->
                <!-- ê°€ê²© í‘œì‹œ ë°•ìŠ¤ -->
                <!-- ============================================ -->
                <div class="price-box bg-gradient-to-br from-blue-600 to-blue-800 text-white rounded-xl shadow-2xl p-8">
                    <h2 class="text-2xl font-bold mb-6">ì˜ˆìƒ ë‚©ë¶€ ê¸ˆì•¡</h2>
                    
                    <!-- ê¸°ê¸° ê°€ê²© -->
                    <div class="space-y-3 mb-6">
                        <div class="flex justify-between items-center">
                            <span class="text-lg">ê¸°ê¸° ì¶œê³ ê°€</span>
                            <span id="display-factory-price" class="text-2xl font-bold">1,200,000ì›</span>
                        </div>
                        
                        <!-- â˜… ê³µí†µì§€ì›ê¸ˆ (ì§€ì›ê¸ˆì•½ì •ì¼ ë•Œë§Œ í‘œì‹œ) â˜… -->
                        <div id="common-subsidy-row" class="flex justify-between items-center text-yellow-300">
                            <span class="text-lg">- ê³µí†µì§€ì›ê¸ˆ</span>
                            <span id="display-common-subsidy" class="text-2xl font-bold">-300,000ì›</span>
                        </div>
                        
                        <!-- ì¶”ê°€ì§€ì›ê¸ˆ (ì„ íƒì•½ì •ì¼ ë•ŒëŠ” ì„ ì•½ì§€ì›ê¸ˆ) -->
                        <div class="flex justify-between items-center text-yellow-300">
                            <span class="text-lg">- ì¶”ê°€ì§€ì›ê¸ˆ</span>
                            <span id="display-additional-subsidy" class="text-2xl font-bold">-200,000ì›</span>
                        </div>
                        
                        <div class="border-t border-white/30 pt-3">
                            <div class="flex justify-between items-center">
                                <span class="text-lg">í• ë¶€ì›ê¸ˆ</span>
                                <span id="display-installment-principal" class="text-2xl font-bold">700,000ì›</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ì›” ë‚©ë¶€ ê¸ˆì•¡ -->
                    <div class="bg-white/10 rounded-lg p-4 mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm">ì›” íœ´ëŒ€í° ìš”ê¸ˆ</span>
                            <span id="phone-month-total" class="text-xl font-bold">29,166ì›</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm">ì›” í†µì‹ ìš”ê¸ˆ</span>
                            <span id="charge-month-total" class="text-xl font-bold">69,000ì›</span>
                        </div>
                    </div>
                    
                    <!-- ìš”ê¸ˆì œ ì •ë³´ -->
                    <div class="space-y-2 mb-6 text-sm">
                        <div class="flex justify-between">
                            <span>ìš”ê¸ˆì œ ê¸°ë³¸ë£Œ</span>
                            <span id="display-plan-price">69,000ì›</span>
                        </div>
                        <div class="flex justify-between text-yellow-300">
                            <span>- ìš”ê¸ˆ í• ì¸ (25%)</span>
                            <span id="display-plan-discount">-0ì›</span>
                        </div>
                    </div>
                    
                    <div class="border-t border-white/30 pt-4">
                        <div class="flex justify-between items-center">
                            <span class="text-xl">ì›” ì´ ë‚©ë¶€ì•¡</span>
                            <span id="total-month-payment" class="text-4xl font-bold">98,166ì›</span>
                        </div>
                    </div>
                </div>

                <!-- ì£¼ë¬¸/ìƒë‹´ ë²„íŠ¼ (ë°ìŠ¤í¬í†±) -->
                <div class="hidden lg:grid grid-cols-2 gap-4">
                    <button onclick="consultProduct()" class="bg-white border-2 border-blue-600 text-blue-600 font-bold py-4 rounded-lg hover:bg-blue-50 transition">
                        ğŸ“ ìƒë‹´ ì‹ ì²­
                    </button>
                    <button onclick="orderProduct()" class="bg-blue-600 text-white font-bold py-4 rounded-lg hover:bg-blue-700 transition">
                        ğŸ›’ ì£¼ë¬¸í•˜ê¸°
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- ============================================ -->
    <!-- ëª¨ë°”ì¼ í•˜ë‹¨ ê³ ì • ë°” -->
    <!-- ============================================ -->
    <div class="lg:hidden mobile-bottom-bar bg-white">
        <div class="px-4 py-3">
            <div class="flex items-center justify-between mb-2">
                <div>
                    <div class="text-xs text-gray-500">ì›” íœ´ëŒ€í° ìš”ê¸ˆ</div>
                    <div id="mobile-phone-price" class="text-lg font-bold">29,166ì›</div>
                </div>
                <div>
                    <div class="text-xs text-gray-500">ì›” í†µì‹ ìš”ê¸ˆ</div>
                    <div id="mobile-charge-price" class="text-lg font-bold">69,000ì›</div>
                </div>
                <div>
                    <div class="text-xs text-gray-500">ì›” ì´ì•¡</div>
                    <div id="mobile-total-price" class="text-xl font-bold text-blue-600">98,166ì›</div>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="consultProduct()" class="bg-white border-2 border-blue-600 text-blue-600 font-bold py-3 rounded-lg">
                    ìƒë‹´
                </button>
                <button onclick="orderProduct()" class="bg-blue-600 text-white font-bold py-3 rounded-lg">
                    ì£¼ë¬¸
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ìš”ê¸ˆì œ ì„ íƒ ëª¨ë‹¬ (íŒì—…) -->
    <!-- ============================================ -->
    <div id="plan-modal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl max-w-4xl w-full max-h-[80vh] overflow-y-auto">
            <div class="sticky top-0 bg-white border-b p-4 flex justify-between items-center">
                <h2 class="text-2xl font-bold">ìš”ê¸ˆì œ ì„ íƒ</h2>
                <button onclick="closePlanModal()" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="plan-modal-content" class="p-6">
                <!-- ìš”ê¸ˆì œ ëª©ë¡ ë™ì  ìƒì„± -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- ë¡œë”© ì¤‘ -->
                    <div class="col-span-2 text-center py-8">
                        <div class="loading-spinner mx-auto"></div>
                        <p class="text-gray-600 mt-4">ìš”ê¸ˆì œ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- JavaScript -->
    <!-- ============================================ -->
    <script>
        // ============================================
        // ì „ì—­ ë³€ìˆ˜
        // ============================================
        let currentDevice = null;
        let currentPlan = null;
        let allPlans = [];
        
        // ============================================
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        // ============================================
        document.addEventListener('DOMContentLoaded', async function() {
            // URLì—ì„œ ê¸°ê¸°ID ê°€ì ¸ì˜¤ê¸°
            const urlParams = new URLSearchParams(window.location.search);
            const deviceId = urlParams.get('device');
            
            if (deviceId) {
                await loadDevice(deviceId);
            }
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            registerEventListeners();
            
            // ìš”ê¸ˆì œ ëª©ë¡ ë¯¸ë¦¬ ë¡œë“œ
            await loadPlans();
        });
        
        // ============================================
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        // ============================================
        function registerEventListeners() {
            // ëª¨ë“  ì˜µì…˜ ë³€ê²½ ì‹œ ê°€ê²© ì¬ê³„ì‚°
            document.querySelectorAll('input[type="radio"]').forEach(input => {
                input.addEventListener('change', recalculatePrice);
            });
        }
        
        // ============================================
        // ê¸°ê¸° ì •ë³´ ë¡œë“œ (ì„ì‹œ - API ì—°ë™ ì˜ˆì •)
        // ============================================
        async function loadDevice(deviceId) {
            // TODO: ì‹¤ì œ API í˜¸ì¶œë¡œ ëŒ€ì²´
            currentDevice = {
                ê¸°ê¸°ì˜µì…˜ID: deviceId,
                ë¸Œëœë“œ: 'ì‚¼ì„±ì „ì',
                ëª¨ë¸ëª…: 'ê°¤ëŸ­ì‹œ S24',
                ìƒ‰ìƒëª…: 'íŒ¬í…€ë¸”ë™',
                ìƒ‰ìƒHEX: '#000000',
                ìš©ëŸ‰: 256,
                ì¶œê³ ê°€: 1200000,
                ì´ë¯¸ì§€URL: 'https://via.placeholder.com/600x600'
            };
            
            // í™”ë©´ì— í‘œì‹œ
            document.getElementById('device-brand').textContent = currentDevice.ë¸Œëœë“œ;
            document.getElementById('device-model').textContent = currentDevice.ëª¨ë¸ëª…;
            document.getElementById('factory-price').textContent = formatPrice(currentDevice.ì¶œê³ ê°€);
            document.getElementById('main-image').src = currentDevice.ì´ë¯¸ì§€URL;
        }
        
        // ============================================
        // ìš”ê¸ˆì œ ëª©ë¡ ë¡œë“œ (ì„ì‹œ - API ì—°ë™ ì˜ˆì •)
        // ============================================
        async function loadPlans() {
            // TODO: ì‹¤ì œ API í˜¸ì¶œë¡œ ëŒ€ì²´
            allPlans = [
                {
                    ìš”ê¸ˆì œID: '5GX_PLAT',
                    ìš”ê¸ˆì œëª…: '5GX í”Œë˜í‹°ë„˜',
                    ì¹´í…Œê³ ë¦¬ëª…: '5GX',
                    ê¸°ë³¸ìš”ê¸ˆ: 125000,
                    ë°ì´í„°ìš©ëŸ‰: 'ë¬´ì œí•œ'
                },
                {
                    ìš”ê¸ˆì œID: 'YOUTH_109',
                    ìš”ê¸ˆì œëª…: '0ì²­ë…„109',
                    ì¹´í…Œê³ ë¦¬ëª…: 'ì²­ë…„',
                    ê¸°ë³¸ìš”ê¸ˆ: 109000,
                    ë°ì´í„°ìš©ëŸ‰: '100GB'
                },
                {
                    ìš”ê¸ˆì œID: 'SENIOR_79',
                    ìš”ê¸ˆì œëª…: 'ì‹œë‹ˆì–´79',
                    ì¹´í…Œê³ ë¦¬ëª…: 'ì‹œë‹ˆì–´',
                    ê¸°ë³¸ìš”ê¸ˆ: 79000,
                    ë°ì´í„°ìš©ëŸ‰: '50GB'
                }
            ];
        }
        
        // ============================================
        // ìš”ê¸ˆì œ ì„ íƒ ëª¨ë‹¬ ì—´ê¸°
        // ============================================
        function openPlanModal() {
            const modal = document.getElementById('plan-modal');
            const content = document.getElementById('plan-modal-content');
            
            // ìš”ê¸ˆì œ ì¹´ë“œ ìƒì„±
            let html = '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
            
            allPlans.forEach(plan => {
                html += `
                    <div class="border-2 border-gray-200 rounded-lg p-4 hover:border-blue-600 cursor-pointer transition"
                         onclick="selectPlan('${plan.ìš”ê¸ˆì œID}')">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <h3 class="font-bold text-lg">${plan.ìš”ê¸ˆì œëª…}</h3>
                                <p class="text-sm text-gray-600">${plan.ì¹´í…Œê³ ë¦¬ëª…}</p>
                            </div>
                            <span class="text-blue-600 font-bold">${formatPrice(plan.ê¸°ë³¸ìš”ê¸ˆ)}/ì›”</span>
                        </div>
                        <div class="text-sm text-gray-700">
                            <p>ğŸ“Š ë°ì´í„°: ${plan.ë°ì´í„°ìš©ëŸ‰}</p>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }
        
        // ============================================
        // ìš”ê¸ˆì œ ì„ íƒ
        // ============================================
        function selectPlan(planId) {
            currentPlan = allPlans.find(p => p.ìš”ê¸ˆì œID === planId);
            
            if (currentPlan) {
                // ì„ íƒëœ ìš”ê¸ˆì œ í‘œì‹œ
                document.getElementById('selected-plan-display').innerHTML = `
                    <div class="text-left">
                        <div class="font-bold text-lg text-gray-900">${currentPlan.ìš”ê¸ˆì œëª…}</div>
                        <div class="text-sm text-gray-600">${formatPrice(currentPlan.ê¸°ë³¸ìš”ê¸ˆ)}/ì›”</div>
                    </div>
                `;
                
                closePlanModal();
                recalculatePrice();
            }
        }
        
        // ============================================
        // ìš”ê¸ˆì œ ì„ íƒ ëª¨ë‹¬ ë‹«ê¸°
        // ============================================
        function closePlanModal() {
            const modal = document.getElementById('plan-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
        
        // ============================================
        // â˜… ê°€ê²© ì¬ê³„ì‚° (í•µì‹¬ í•¨ìˆ˜) â˜…
        // ============================================
        async function recalculatePrice() {
            if (!currentDevice || !currentPlan) {
                return;
            }
            
            // í˜„ì¬ ì„ íƒê°’ ê°€ì ¸ì˜¤ê¸°
            const joinType = document.querySelector('input[name="type_subscription"]:checked')?.value;
            const discountType = document.querySelector('input[name="type_discount"]:checked')?.value;
            const installmentMonths = parseInt(document.querySelector('input[name="type_period"]:checked')?.value || '24');
            
            if (!joinType || !discountType) {
                return;
            }
            
            // ê°€ê²© ê³„ì‚°
            const result = calculatePrice(
                currentDevice,
                currentPlan,
                joinType,
                discountType,
                installmentMonths
            );
            
            // í™”ë©´ ì—…ë°ì´íŠ¸
            updatePriceDisplay(result);
        }
        
        // ============================================
        // ê°€ê²© ê³„ì‚° ë¡œì§
        // ============================================
        function calculatePrice(device, plan, joinType, discountType, installmentMonths) {
            const factoryPrice = device.ì¶œê³ ê°€;
            const planPrice = plan.ê¸°ë³¸ìš”ê¸ˆ;
            
            // TODO: ì‹¤ì œë¡œëŠ” APIì—ì„œ ì§€ì›ê¸ˆ ì •ë³´ ê°€ì ¸ì™€ì•¼ í•¨
            // ì„ì‹œ ë°ì´í„°
            const subsidy = {
                ê³µí†µì§€ì›ê¸ˆ: 300000,
                ì¶”ê°€ì§€ì›ê¸ˆ: 200000,
                ì„ ì•½ì§€ì›ê¸ˆ: 400000
            };
            
            let result = {};
            
            if (discountType === 'phone') {
                // ì§€ì›ê¸ˆì•½ì •
                const totalSubsidy = subsidy.ê³µí†µì§€ì›ê¸ˆ + subsidy.ì¶”ê°€ì§€ì›ê¸ˆ;
                const installmentPrincipal = factoryPrice - totalSubsidy;
                
                result = {
                    ì•½ì •ìœ í˜•: 'ì§€ì›ê¸ˆì•½ì •',
                    ì¶œê³ ê°€: factoryPrice,
                    ê³µí†µì§€ì›ê¸ˆ: subsidy.ê³µí†µì§€ì›ê¸ˆ,
                    ì¶”ê°€ì§€ì›ê¸ˆ: subsidy.ì¶”ê°€ì§€ì›ê¸ˆ,
                    ì´ì§€ì›ê¸ˆ: totalSubsidy,
                    í• ë¶€ì›ê¸ˆ: installmentPrincipal,
                    ì›”í• ë¶€ê¸ˆ: calculateInstallment(installmentPrincipal, installmentMonths),
                    ìš”ê¸ˆì œê¸°ë³¸ë£Œ: planPrice,
                    ìš”ê¸ˆí• ì¸: 0,
                    ì›”í†µì‹ ìš”ê¸ˆ: planPrice,
                    display: {
                        ê³µí†µì§€ì›ê¸ˆí‘œì‹œ: true,
                        ê³µí†µì§€ì›ê¸ˆ: subsidy.ê³µí†µì§€ì›ê¸ˆ,
                        ì¶”ê°€ì§€ì›ê¸ˆ: subsidy.ì¶”ê°€ì§€ì›ê¸ˆ
                    }
                };
            } else {
                // ì„ íƒì•½ì •
                const selectSubsidy = subsidy.ì„ ì•½ì§€ì›ê¸ˆ;
                const installmentPrincipal = factoryPrice - selectSubsidy;
                const planDiscount = Math.round(planPrice * 0.25);
                
                result = {
                    ì•½ì •ìœ í˜•: 'ì„ íƒì•½ì •',
                    ì¶œê³ ê°€: factoryPrice,
                    ê³µí†µì§€ì›ê¸ˆ: 0,
                    ì¶”ê°€ì§€ì›ê¸ˆ: selectSubsidy, // â˜… ì„ ì•½ì§€ì›ê¸ˆì„ ì¶”ê°€ì§€ì›ê¸ˆìœ¼ë¡œ í‘œì‹œ
                    ì´ì§€ì›ê¸ˆ: selectSubsidy,
                    í• ë¶€ì›ê¸ˆ: installmentPrincipal,
                    ì›”í• ë¶€ê¸ˆ: calculateInstallment(installmentPrincipal, installmentMonths),
                    ìš”ê¸ˆì œê¸°ë³¸ë£Œ: planPrice,
                    ìš”ê¸ˆí• ì¸: planDiscount,
                    ì›”í†µì‹ ìš”ê¸ˆ: planPrice - planDiscount,
                    display: {
                        ê³µí†µì§€ì›ê¸ˆí‘œì‹œ: false, // â˜… ê³µí†µì§€ì›ê¸ˆ ìˆ¨ê¹€
                        ê³µí†µì§€ì›ê¸ˆ: 0,
                        ì¶”ê°€ì§€ì›ê¸ˆ: selectSubsidy
                    }
                };
            }
            
            // ì›” ì´ ë‚©ë¶€ì•¡
            result.ì›”ì´ë‚©ë¶€ì•¡ = result.ì›”í• ë¶€ê¸ˆ + result.ì›”í†µì‹ ìš”ê¸ˆ;
            
            return result;
        }
        
        // ============================================
        // í• ë¶€ ê³„ì‚° (ì›ë¦¬ê¸ˆê· ë“±ìƒí™˜)
        // ============================================
        function calculateInstallment(principal, months) {
            if (months === 0) return principal;
            
            const rate = 0.059 / 12; // ì›” ì´ììœ¨ 5.9% / 12
            const payment = principal * 
                (rate * Math.pow(1 + rate, months)) / 
                (Math.pow(1 + rate, months) - 1);
            
            return Math.round(payment / 100) * 100; // 100ì› ë‹¨ìœ„ ë°˜ì˜¬ë¦¼
        }
        
        // ============================================
        // í™”ë©´ ì—…ë°ì´íŠ¸
        // ============================================
        function updatePriceDisplay(result) {
            // ì¶œê³ ê°€
            document.getElementById('display-factory-price').textContent = formatPrice(result.ì¶œê³ ê°€);
            
            // â˜… ê³µí†µì§€ì›ê¸ˆ í–‰ í‘œì‹œ/ìˆ¨ê¹€ â˜…
            const commonSubsidyRow = document.getElementById('common-subsidy-row');
            if (result.display.ê³µí†µì§€ì›ê¸ˆí‘œì‹œ) {
                commonSubsidyRow.style.display = 'flex';
                document.getElementById('display-common-subsidy').textContent = formatPrice(-result.display.ê³µí†µì§€ì›ê¸ˆ);
            } else {
                commonSubsidyRow.style.display = 'none';
            }
            
            // ì¶”ê°€ì§€ì›ê¸ˆ
            document.getElementById('display-additional-subsidy').textContent = formatPrice(-result.display.ì¶”ê°€ì§€ì›ê¸ˆ);
            
            // í• ë¶€ì›ê¸ˆ
            document.getElementById('display-installment-principal').textContent = formatPrice(result.í• ë¶€ì›ê¸ˆ);
            
            // ì›” íœ´ëŒ€í° ìš”ê¸ˆ
            document.getElementById('phone-month-total').textContent = formatPrice(result.ì›”í• ë¶€ê¸ˆ);
            
            // ìš”ê¸ˆì œ ê¸°ë³¸ë£Œ
            document.getElementById('display-plan-price').textContent = formatPrice(result.ìš”ê¸ˆì œê¸°ë³¸ë£Œ);
            
            // ìš”ê¸ˆí• ì¸
            document.getElementById('display-plan-discount').textContent = formatPrice(-result.ìš”ê¸ˆí• ì¸);
            
            // ì›” í†µì‹ ìš”ê¸ˆ
            document.getElementById('charge-month-total').textContent = formatPrice(result.ì›”í†µì‹ ìš”ê¸ˆ);
            
            // ì›” ì´ ë‚©ë¶€ì•¡
            document.getElementById('total-month-payment').textContent = formatPrice(result.ì›”ì´ë‚©ë¶€ì•¡);
            
            // ëª¨ë°”ì¼ í•˜ë‹¨ë°”
            document.getElementById('mobile-phone-price').textContent = formatPrice(result.ì›”í• ë¶€ê¸ˆ);
            document.getElementById('mobile-charge-price').textContent = formatPrice(result.ì›”í†µì‹ ìš”ê¸ˆ);
            document.getElementById('mobile-total-price').textContent = formatPrice(result.ì›”ì´ë‚©ë¶€ì•¡);
        }
        
        // ============================================
        // ìœ í‹¸ë¦¬í‹°: ê°€ê²© í¬ë§·íŒ…
        // ============================================
        function formatPrice(price) {
            return price.toLocaleString('ko-KR') + 'ì›';
        }
        
        // ============================================
        // ì´ë¯¸ì§€ ë³€ê²½
        // ============================================
        function changeMainImage(src) {
            document.getElementById('main-image').src = src;
            
            // ì¸ë„¤ì¼ border ë³€ê²½
            document.querySelectorAll('.sticky-gallery img').forEach(img => {
                if (img.src === src) {
                    img.classList.remove('border-gray-300');
                    img.classList.add('border-blue-600');
                } else {
                    img.classList.remove('border-blue-600');
                    img.classList.add('border-gray-300');
                }
            });
        }
        
        // ============================================
        // ìƒë‹´ ì‹ ì²­
        // ============================================
        function consultProduct() {
            // ìƒë‹´ ì‹ ì²­ í˜ì´ì§€ë¡œ ì´ë™
            window.location.href = 'contact.html';
        }
        
        // ============================================
        // ì£¼ë¬¸í•˜ê¸°
        // ============================================
        function orderProduct() {            
            if (!currentPlan) {
                alert('ìš”ê¸ˆì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì£¼ë¬¸ í˜ì´ì§€ë¡œ ì´ë™ (ë°ì´í„° ì „ë‹¬)
            alert('ì£¼ë¬¸í•˜ê¸° ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
        }
        
        // ============================================
        // ëª¨ë°”ì¼ ë©”ë‰´ í† ê¸€
        // ============================================
        function toggleMobileMenu() {
            alert('ëª¨ë°”ì¼ ë©”ë‰´ ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.');
        }
    </script>

<!-- ============================================ -->
<!-- ìš”ê¸ˆì œ ì„ íƒ ëª¨ë‹¬ -->
<!-- ============================================ -->
<div id="plans-modal" class="modal">
    <div class="modal-content">
        <!-- ëª¨ë‹¬ í—¤ë” -->
        <div class="modal-header">
            <h2 class="text-2xl font-bold">ìš”ê¸ˆì œ ì„ íƒ</h2>
            <button class="modal-close" onclick="closePlanModal()">Ã—</button>
        </div>
        
        <!-- ëª¨ë‹¬ ë°”ë”” -->
        <div class="modal-body">
            <!-- ì¹´í…Œê³ ë¦¬ íƒ­ -->
            <div class="flex space-x-2 mb-6 overflow-x-auto pb-2">
                <button class="plan-category-btn active" data-category="all">
                    ì „ì²´
                </button>
                <button class="plan-category-btn" data-category="5GX">
                    5GX
                </button>
                <button class="plan-category-btn" data-category="ì²­ë…„">
                    ì²­ë…„
                </button>
                <button class="plan-category-btn" data-category="ì‹œë‹ˆì–´">
                    ì‹œë‹ˆì–´
                </button>
                <button class="plan-category-btn" data-category="LTE">
                    LTE
                </button>
            </div>
            
            <!-- ìš”ê¸ˆì œ ëª©ë¡ -->
            <div id="plans-list" class="space-y-4">
                <!-- ë¡œë”© -->
                <div class="text-center py-12">
                    <div class="loading-spinner mx-auto mb-4"></div>
                    <p class="text-gray-600">ìš”ê¸ˆì œ ë¡œë”© ì¤‘...</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* ëª¨ë‹¬ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 9999;
    align-items: center;
    justify-content: center;
}

.modal.active {
    display: flex;
}

.modal-content {
    background: white;
    border-radius: 16px;
    width: 90%;
    max-width: 800px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 24px;
    border-bottom: 1px solid #e5e7eb;
}

.modal-close {
    font-size: 32px;
    line-height: 1;
    border: none;
    background: none;
    cursor: pointer;
    color: #6b7280;
    padding: 0;
    width: 32px;
    height: 32px;
}

.modal-close:hover {
    color: #000;
}

.modal-body {
    padding: 24px;
    overflow-y: auto;
    flex: 1;
}

/* ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ */
.plan-category-btn {
    padding: 8px 16px;
    border-radius: 20px;
    background: #f3f4f6;
    border: 2px solid transparent;
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
}

.plan-category-btn:hover {
    background: #e5e7eb;
}

.plan-category-btn.active {
    background: #2563eb;
    color: white;
    border-color: #2563eb;
}

/* ìš”ê¸ˆì œ ì¹´ë“œ */
.plan-card {
    border: 2px solid #e5e7eb;
    border-radius: 12px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.2s;
}

.plan-card:hover {
    border-color: #2563eb;
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.1);
}

.plan-card.selected {
    border-color: #2563eb;
    background: #eff6ff;
}

/* ëª¨ë°”ì¼ ëŒ€ì‘ */
@media (max-width: 768px) {
    .modal-content {
        width: 100%;
        height: 100%;
        max-height: 100vh;
        border-radius: 0;
    }
}
</style>

<!-- JavaScript -->
<script src="js/api.js"></script>
<script src="js/common.js"></script>
<script src="js/calculator.js"></script>
<script src="js/plans-modal.js"></script>
<script src="js/device-detail.js"></script>

</body>
</html>