<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <base href="/tworld-store-frontend/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKT ê³µì‹ ì˜¨ë¼ì¸ìƒµ - ìµœì‹  ìŠ¤ë§ˆíŠ¸í°</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- í—¤ë” -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <span class="logo-text">í‹°ì›”ë“œìŠ¤í† ì–´</span>
                </a>
                <nav class="main-nav">
                    <a href="devices.html?brand=samsung">ì‚¼ì„±</a>
                    <a href="devices.html?brand=apple">ì• í”Œ</a>
                    <a href="devices.html">ì „ì²´ê¸°ê¸°</a>
                    <a href="plans.html">ìš”ê¸ˆì œ</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- íˆì–´ë¡œ ìŠ¬ë¼ì´ë” -->
    <section class="hero-section">
        <div class="hero-slider" id="hero-slider">
            <!-- JSë¡œ ë™ì  ìƒì„± -->
            <div class="slider-loading">
                <p>ë¡œë”© ì¤‘...</p>
            </div>
        </div>
        <div class="slider-dots" id="slider-dots">
            <!-- JSë¡œ ë™ì  ìƒì„± -->
        </div>
    </section>

    <!-- ì¸ê¸° ê¸°ê¸° ì„¹ì…˜ -->
    <section class="popular-section">
        <div class="container">
            <h2 class="section-title" id="popular-title">ìµœì‹  ìŠ¤ë§ˆíŠ¸í°</h2>
            <div class="devices-grid" id="popular-devices">
                <!-- JSë¡œ ë™ì  ìƒì„± -->
                <div class="loading-placeholder">
                    <p>ê¸°ê¸° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- ì¤‘ê°„ ë°°ë„ˆ -->
    <section class="middle-banner-section" id="middle-banner-section">
        <!-- JSë¡œ ë™ì  ìƒì„± -->
    </section>

    <!-- í•˜ë‹¨ í”„ë¡œëª¨ì…˜ -->
    <section class="promo-section">
        <div class="container">
            <div class="promo-grid" id="promo-grid">
                <!-- JSë¡œ ë™ì  ìƒì„± -->
            </div>
        </div>
    </section>

    <!-- í‘¸í„° -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <p>ê³ ê°ì„¼í„°: 1600-8939</p>
                    <p>ìƒë‹´ì‹œê°„: í‰ì¼ 09:00 - 18:00</p>
                </div>
                <div class="footer-legal">
                    <p>Â© 2025 SKT. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- JS íŒŒì¼ ë¡œë“œ -->
    <script src="js/cloudinary.js"></script>
    <script src="js/api.js"></script>
    <script src="js/calculator.js"></script>
    <script src="js/common.js"></script>
    
    <!-- ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        /**
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         * index.html ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         */

        // Cloudinary ì„¤ì • (ì‹¤ì œ ì‚¬ìš©ì‹œ ë³€ê²½ í•„ìš”)
        setCloudinaryConfig('tworld-store');

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * í˜ì´ì§€ ì´ˆê¸°í™”
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log('ğŸš€ index.html ë¡œë“œ ì‹œì‘');
                
                // 1. images-index.json ë¡œë“œ
                const imagesData = await api.loadImagesIndex();
                console.log('âœ… images-index.json ë¡œë“œ ì™„ë£Œ');
                
                // 2. ê° ì„¹ì…˜ ë Œë”ë§
                await Promise.all([
                    renderHeroSlider(imagesData.hero_slider),
                    renderPopularDevices(imagesData.popular_devices),
                    renderMiddleBanner(imagesData.middle_banner),
                    renderPromoBlocks(imagesData.bottom_promos)
                ]);
                
                console.log('âœ… ëª¨ë“  ì„¹ì…˜ ë Œë”ë§ ì™„ë£Œ');
                
            } catch (error) {
                console.error('âŒ í˜ì´ì§€ ë¡œë“œ ì‹¤íŒ¨:', error);
                showError('í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        });

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * íˆì–´ë¡œ ìŠ¬ë¼ì´ë” ë Œë”ë§
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        async function renderHeroSlider(sliderConfig) {
            if (!sliderConfig || !sliderConfig.enabled) {
                document.querySelector('.hero-section').style.display = 'none';
                return;
            }
            
            const slider = document.getElementById('hero-slider');
            const dots = document.getElementById('slider-dots');
            
            // ìŠ¬ë¼ì´ë“œ ìƒì„±
            slider.innerHTML = '';
            dots.innerHTML = '';
            
            sliderConfig.slides.forEach((slide, index) => {
                // ìŠ¬ë¼ì´ë“œ ì•„ì´í…œ
                const slideItem = document.createElement('div');
                slideItem.className = 'slider-item' + (index === 0 ? ' active' : '');
                
                const link = document.createElement('a');
                link.href = slide.link || '#';
                
                const img = document.createElement('img');
                img.src = getBannerUrl(slide.path, 'hero');
                img.alt = slide.alt;
                img.loading = index === 0 ? 'eager' : 'lazy';
                
                link.appendChild(img);
                slideItem.appendChild(link);
                slider.appendChild(slideItem);
                
                // ë„íŠ¸ ì¸ë””ì¼€ì´í„°
                const dot = document.createElement('button');
                dot.className = 'slider-dot' + (index === 0 ? ' active' : '');
                dot.setAttribute('aria-label', `ìŠ¬ë¼ì´ë“œ ${index + 1}`);
                dot.onclick = () => goToSlide(index);
                dots.appendChild(dot);
            });
            
            // ìë™ ì¬ìƒ
            if (sliderConfig.auto_play) {
                startAutoPlay(sliderConfig.interval || 5000);
            }
        }

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * ìŠ¬ë¼ì´ë” ìë™ ì¬ìƒ
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        let autoPlayInterval;
        let currentSlide = 0;
        
        function startAutoPlay(interval) {
            autoPlayInterval = setInterval(() => {
                const slides = document.querySelectorAll('.slider-item');
                currentSlide = (currentSlide + 1) % slides.length;
                goToSlide(currentSlide);
            }, interval);
        }
        
        function goToSlide(index) {
            const slides = document.querySelectorAll('.slider-item');
            const dots = document.querySelectorAll('.slider-dot');
            
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));
            
            slides[index].classList.add('active');
            dots[index].classList.add('active');
            
            currentSlide = index;
        }

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * ì¸ê¸° ê¸°ê¸° ë Œë”ë§
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        async function renderPopularDevices(popularConfig) {
            if (!popularConfig || !popularConfig.enabled) {
                document.querySelector('.popular-section').style.display = 'none';
                return;
            }
            
            // ì œëª© ì„¤ì •
            document.getElementById('popular-title').textContent = 
                popularConfig.title || 'ìµœì‹  ìŠ¤ë§ˆíŠ¸í°';
            
            const container = document.getElementById('popular-devices');
            container.innerHTML = '';
            
            // í‘œì‹œí•  ëª¨ë¸ ìˆ˜ ì œí•œ
            const modelsToShow = popularConfig.models.slice(0, popularConfig.layout || 8);
            
            // ê° ëª¨ë¸ë³„ ì¹´ë“œ ìƒì„±
            for (const modelName of modelsToShow) {
                try {
                    // ì™„ì „í•œ ì¹´ë“œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (images + products)
                    const cardData = await api.getCardData(modelName);
                    
                    if (!cardData) {
                        console.warn(`ì¹´ë“œ ë°ì´í„° ì—†ìŒ: ${modelName}`);
                        continue;
                    }
                    
                    // ê°€ê²© ê³„ì‚°
                    const priceResult = calculatePrice(
                        cardData.device,
                        cardData.plan,
                        cardData.subsidy,
                        {
                            discountType: cardData.image.card.default.join_type === 'ê¸°ê¸°ë³€ê²½' ? 'subsidy' : 'subsidy',
                            installmentMonths: 24,
                            internetTv: 'none'
                        }
                    );
                    
                    // ì¸ë„¤ì¼ URL
                    const defaultColor = cardData.image.card.default.color;
                    const thumbnailPath = cardData.image.thumbnails[defaultColor].path;
                    const thumbnailUrl = getThumbnailUrl(thumbnailPath, 'medium');
                    
                    // ë±ƒì§€
                    const badge = popularConfig.badges && popularConfig.badges[modelName];
                    
                    // ì¹´ë“œ ìƒì„±
                    const card = createDeviceCard({
                        modelName: modelName,
                        title: cardData.image.card.title,
                        subtitle: cardData.image.card.subtitle,
                        thumbnailUrl: thumbnailUrl,
                        monthlyTotal: priceResult.monthlyTotal,
                        subsidyTotal: priceResult.subsidy.total,
                        badge: badge
                    });
                    
                    container.appendChild(card);
                    
                } catch (error) {
                    console.error(`ì¹´ë“œ ìƒì„± ì‹¤íŒ¨: ${modelName}`, error);
                }
            }
        }

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * ê¸°ê¸° ì¹´ë“œ ìƒì„±
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        function createDeviceCard(data) {
            const card = document.createElement('div');
            card.className = 'device-card';
            card.onclick = () => {
                location.href = `device-detail.html?device=${encodeURIComponent(data.modelName)}`;
            };
            
            card.innerHTML = `
                <div class="device-card-image">
                    <img src="${data.thumbnailUrl}" alt="${data.title}" loading="lazy">
                    ${data.badge ? `<span class="badge" style="background-color: ${data.badge.color}">${data.badge.text}</span>` : ''}
                </div>
                <div class="device-card-body">
                    <h3 class="device-title">${data.title}</h3>
                    <p class="device-subtitle">${data.subtitle}</p>
                    <div class="device-prices">
                        <div class="price-row">
                            <span class="price-label">ì¶œê³ ê°€ í• ì¸ê¸ˆ</span>
                            <span class="price-value">${formatDiscount(data.subsidyTotal)}</span>
                        </div>
                        <div class="price-row total">
                            <span class="price-label">ì›” ì˜ˆìƒ ë‚©ë¶€</span>
                            <span class="price-value highlight">${formatMonthly(data.monthlyTotal)}</span>
                        </div>
                    </div>
                </div>
            `;
            
            return card;
        }

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * ì¤‘ê°„ ë°°ë„ˆ ë Œë”ë§
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        function renderMiddleBanner(bannerConfig) {
            const section = document.getElementById('middle-banner-section');
            
            if (!bannerConfig || !bannerConfig.enabled) {
                section.style.display = 'none';
                return;
            }
            
            const bannerUrl = getBannerUrl(bannerConfig.path, 'middle');
            
            section.innerHTML = `
                <div class="container">
                    <a href="${bannerConfig.link || '#'}" class="middle-banner-link">
                        <img src="${bannerUrl}" alt="${bannerConfig.alt}" loading="lazy">
                    </a>
                </div>
            `;
        }

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * í•˜ë‹¨ í”„ë¡œëª¨ì…˜ ë¸”ë¡ ë Œë”ë§
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        function renderPromoBlocks(promosConfig) {
            if (!promosConfig || !promosConfig.enabled) {
                document.querySelector('.promo-section').style.display = 'none';
                return;
            }
            
            const container = document.getElementById('promo-grid');
            container.innerHTML = '';
            
            // ë ˆì´ì•„ì›ƒì— ë”°ë¼ í´ë˜ìŠ¤ ì„¤ì •
            container.className = `promo-grid layout-${promosConfig.layout}`;
            
            // ê° í”„ë¡œëª¨ì…˜ ë¸”ë¡
            promosConfig.items.forEach(item => {
                const promoUrl = getBannerUrl(item.path, 'promo');
                
                const promoItem = document.createElement('div');
                promoItem.className = 'promo-item';
                
                promoItem.innerHTML = `
                    <a href="${item.link || '#'}">
                        <img src="${promoUrl}" alt="${item.alt}" loading="lazy">
                    </a>
                `;
                
                container.appendChild(promoItem);
            });
        }

        /**
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         * ì—ëŸ¬ í‘œì‹œ
         * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         */
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            document.body.insertBefore(errorDiv, document.body.firstChild);
        }
    </script>
</body>
</html>