# 01. ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜

> **ë²„ì „**: v1.0  
> **ì‘ì„±ì¼**: 2025-11-06

---

## ğŸ“¦ ê¸°ìˆ  ìŠ¤íƒ (ì •í™•í•œ ë²„ì „ ëª…ì‹œ)

### Frontend (Admin)
```json
{
  "react": "^18.2.0",
  "react-dom": "^18.2.0",
  "typescript": "^5.0.0",
  "vite": "^5.0.0",
  "zustand": "^4.4.0",
  "antd": "^5.12.0",
  "@craftjs/core": "^0.2.0",
  "react-dnd": "^16.0.0",
  "tinymce": "^6.0.0",
  "axios": "^1.6.0"
}
```

### Backend
```json
{
  "node": "18.x LTS",
  "firebase-functions": "^4.5.0",
  "firebase-admin": "^11.11.0",
  "express": "^4.18.0"
}
```

### Database & Storage
```yaml
Firestore: ìµœì‹  ë²„ì „ (Firebase SDK)
Firebase Storage: ìµœì‹  ë²„ì „
Cloudinary: API v2
Google Sheets API: v4
```

### Hosting & Deployment
```yaml
Vercel: ìµœì‹  ë²„ì „
Firebase Hosting: ìµœì‹  ë²„ì „
GitHub Actions: ìµœì‹  ë²„ì „
```

### Development Tools
```json
{
  "eslint": "^8.0.0",
  "prettier": "^3.0.0",
  "jest": "^29.0.0",
  "@testing-library/react": "^14.0.0"
}
```

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì¡°ë„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ì‚¬ìš©ì (Browser)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€ Frontend (Vercel) â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    â€¢ ì •ì  HTML/CSS/JS       â”‚
         â”‚    â€¢ products.json ì‚¬ìš©    â”‚
         â”‚                             â”‚
         â””â”€â”€â”€ Admin (Firebase) â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â€¢ React SPA             â”‚
              â€¢ í˜ì´ì§€ ë¹Œë”             â”‚
                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚       Backend (Firebase)         â”‚ â†â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Functions (API)                â”‚
â”‚ â€¢ Firestore (pages, products)    â”‚
â”‚ â€¢ Storage (temp files)           â”‚
â”‚ â€¢ Authentication                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€ Google Sheets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚    â€¢ ìƒí’ˆ ë§ˆìŠ¤í„° ë°ì´í„°      â”‚
         â”‚    â€¢ ìƒë‹´ ì‹ ì²­ ì €ì¥         â”‚
         â”‚                            â”‚
         â”œâ”€â”€â”€ Cloudinary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚    â€¢ ì´ë¯¸ì§€ ì €ì¥/ë³€í™˜        â”‚
         â”‚                            â”‚
         â””â”€â”€â”€ Telegram Bot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â€¢ ìƒë‹´ ì•Œë¦¼
```

---

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### 1. ìƒí’ˆ ë°ì´í„° ë™ê¸°í™”
```
Google Sheets (ë§ˆìŠ¤í„°)
  â†“ [GAS íŠ¸ë¦¬ê±° - 1ì‹œê°„ ì£¼ê¸°]
products.json ìƒì„±
  â†“ [GAS]
GitHub Repository ì—…ë¡œë“œ
  â†“ [Vercel ìë™ ë°°í¬]
Frontendì—ì„œ ì‚¬ìš©
  â†“ [CDN ìºì‹±]
ì‚¬ìš©ìì—ê²Œ ì œê³µ

ë³‘ë ¬ ì²˜ë¦¬:
Google Sheets â†’ Firebase Functions â†’ Firestore
(ê²€ìƒ‰/í•„í„°ë§ìš©)
```

### 2. í˜ì´ì§€ ìƒì„± í”Œë¡œìš°
```
Admin (Craft.js)
  â†“ [ì‚¬ìš©ì í¸ì§‘]
JSON êµ¬ì¡° ìƒì„±
  â†“ [Firebase Functions]
HTML íŒŒì¼ ìƒì„±
  â†“ [Vercel API]
ì •ì  ì‚¬ì´íŠ¸ ë°°í¬
  â†“ [CDN]
ì‚¬ìš©ì ì ‘ê·¼
```

### 3. ìƒë‹´ ì‹ ì²­ í”Œë¡œìš°
```
Frontend í¼
  â†“ [POST]
Firebase Functions
  â†“ [ë³‘ë ¬ ì²˜ë¦¬]
  â”œâ”€â”€ Google Sheets ì €ì¥ (GAS API)
  â””â”€â”€ Telegram Bot ì•Œë¦¼
  â†“ [ì‘ë‹µ]
ì‚¬ìš©ìì—ê²Œ í™•ì¸ ë©”ì‹œì§€
```

### 4. ì´ë¯¸ì§€ ì—…ë¡œë“œ í”Œë¡œìš°
```
Admin ì´ë¯¸ì§€ ì—…ë¡œë“œ
  â†“ [Cloudinary Upload API]
ì´ë¯¸ì§€ ì €ì¥ + ë³€í™˜ (WebP)
  â†“ [URL ë°˜í™˜]
Firestoreì— URL ì €ì¥
  â†“ [í˜ì´ì§€ ë¹Œë”]
ì´ë¯¸ì§€ ë¸”ë¡ì— ì‚¬ìš©
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (Firestore)

### Collections êµ¬ì¡°
```
firestore/
â”œâ”€â”€ pages/                    # í˜ì´ì§€ ë°ì´í„°
â”‚   â””â”€â”€ {pageId}/
â”‚       â”œâ”€â”€ id: string
â”‚       â”œâ”€â”€ title: string
â”‚       â”œâ”€â”€ slug: string
â”‚       â”œâ”€â”€ sections: array
â”‚       â”œâ”€â”€ status: enum
â”‚       â””â”€â”€ updatedAt: timestamp
â”‚
â”œâ”€â”€ products/                 # ìƒí’ˆ ë°ì´í„° (Sheets ë™ê¸°í™”)
â”‚   â””â”€â”€ {productId}/
â”‚       â”œâ”€â”€ id: string
â”‚       â”œâ”€â”€ brand: string
â”‚       â”œâ”€â”€ model: string
â”‚       â”œâ”€â”€ price: number
â”‚       â””â”€â”€ syncedAt: timestamp
â”‚
â”œâ”€â”€ consultations/            # ìƒë‹´ ì‹ ì²­
â”‚   â””â”€â”€ {consultationId}/
â”‚       â”œâ”€â”€ customerName: string
â”‚       â”œâ”€â”€ phone: string
â”‚       â”œâ”€â”€ deviceId: string
â”‚       â””â”€â”€ createdAt: timestamp
â”‚
â”œâ”€â”€ boards/                   # ê²Œì‹œíŒ
â”‚   â””â”€â”€ {boardId}/
â”‚       â”œâ”€â”€ name: string
â”‚       â”œâ”€â”€ slug: string
â”‚       â””â”€â”€ settings: object
â”‚
â””â”€â”€ board_posts/              # ê²Œì‹œê¸€
    â””â”€â”€ {postId}/
        â”œâ”€â”€ boardId: string
        â”œâ”€â”€ title: string
        â”œâ”€â”€ content: string
        â””â”€â”€ createdAt: timestamp
```

> ìƒì„¸ íƒ€ì… ì •ì˜ëŠ” `03_íƒ€ì…ì •ì˜.md` ì°¸ì¡°

---

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸ êµ¬ì¡°

### Firebase Functions
```
Base URL: https://us-central1-{project-id}.cloudfunctions.net
ë˜ëŠ”: https://api.tworld-store.com (ì»¤ìŠ¤í…€ ë„ë©”ì¸)

/api/
â”œâ”€â”€ products/
â”‚   â”œâ”€â”€ GET  /list              # ìƒí’ˆ ëª©ë¡
â”‚   â”œâ”€â”€ GET  /:id               # ìƒí’ˆ ìƒì„¸
â”‚   â””â”€â”€ POST /sync              # Sheets ë™ê¸°í™” (ìˆ˜ë™)
â”‚
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ GET  /:pageId           # í˜ì´ì§€ ë°ì´í„°
â”‚   â”œâ”€â”€ POST /generate          # HTML ìƒì„±
â”‚   â””â”€â”€ POST /publish           # Vercel ë°°í¬
â”‚
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ POST /upload            # Cloudinary ì—…ë¡œë“œ
â”‚   â””â”€â”€ POST /process           # ì´ë¯¸ì§€ ì²˜ë¦¬
â”‚
â”œâ”€â”€ forms/
â”‚   â””â”€â”€ POST /consultation      # ìƒë‹´ ì‹ ì²­
â”‚
â””â”€â”€ boards/
    â”œâ”€â”€ GET  /:boardId/posts    # ê²Œì‹œê¸€ ëª©ë¡
    â”œâ”€â”€ GET  /posts/:postId     # ê²Œì‹œê¸€ ìƒì„¸
    â”œâ”€â”€ POST /posts             # ê²Œì‹œê¸€ ì‘ì„±
    â””â”€â”€ PUT  /posts/:postId     # ê²Œì‹œê¸€ ìˆ˜ì •
```

> ìƒì„¸ ìš”ì²­/ì‘ë‹µ íƒ€ì…ì€ `04_APIëª…ì„¸.md` ì°¸ì¡°

---

## ğŸ” ë³´ì•ˆ ë° ì¸ì¦

### Firebase Security Rules

#### Firestore Rules
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // í˜ì´ì§€ - ê³µê°œëŠ” ì½ê¸°ë§Œ, ì“°ê¸°ëŠ” ê´€ë¦¬ìë§Œ
    match /pages/{pageId} {
      allow read: if resource.data.status == 'published';
      allow write: if request.auth != null && 
                     request.auth.token.admin == true;
    }
    
    // ìƒí’ˆ - ì½ê¸° ì „ìš© (Functionsë§Œ ì“°ê¸°)
    match /products/{productId} {
      allow read: if true;
      allow write: if false;
    }
    
    // ìƒë‹´ - ìƒì„±ë§Œ í—ˆìš©
    match /consultations/{consultationId} {
      allow create: if true;
      allow read, update, delete: if request.auth != null;
    }
    
    // ê²Œì‹œíŒ - ê³µê°œ ê²Œì‹œíŒì€ ì½ê¸°ë§Œ
    match /boards/{boardId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /board_posts/{postId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
}
```

#### Storage Rules
```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // ì´ë¯¸ì§€ - ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì—…ë¡œë“œ
    match /images/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null &&
                     request.resource.size < 5 * 1024 * 1024; // 5MB
    }
  }
}
```

### í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬

#### .env.production (ì ˆëŒ€ Gitì— ì»¤ë°‹ ê¸ˆì§€)
```bash
# Firebase
VITE_FIREBASE_API_KEY=AIzaSy...
VITE_FIREBASE_AUTH_DOMAIN=tworld-store.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=tworld-store
VITE_FIREBASE_STORAGE_BUCKET=tworld-store.appspot.com

# Cloudinary
VITE_CLOUDINARY_CLOUD_NAME=tworld-store
VITE_CLOUDINARY_UPLOAD_PRESET=ml_default

# Google Sheets
VITE_GOOGLE_SHEETS_ID=1abc...xyz
VITE_GAS_WEB_APP_URL=https://script.google.com/...

# Telegram
VITE_TELEGRAM_BOT_TOKEN=123456:ABC...
VITE_TELEGRAM_CHAT_ID=-1001234567890

# API
VITE_API_BASE_URL=https://api.tworld-store.com
VITE_CDN_URL=https://cdn.tworld-store.com
```

---

## ğŸ“Š ì„±ëŠ¥ ìµœì í™” ì „ëµ

### 1. ì´ë¯¸ì§€ ìµœì í™”
```yaml
Cloudinary ë³€í™˜:
  - WebP ìë™ ë³€í™˜ (f_auto,q_auto)
  - ë°˜ì‘í˜• í¬ê¸° (w_auto:100:1200)
  - Lazy Loading (loading="lazy")

Cache:
  - CDN ìºì‹œ: 1ë…„ (immutable)
  - Browser ìºì‹œ: 1ì£¼ì¼
```

### 2. ë°ì´í„° ìºì‹±
```yaml
products.json:
  - GitHubì— ì €ì¥
  - Vercel Edge Network ìºì‹±
  - 1ì‹œê°„ ê°±ì‹ 

Firestore:
  - ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°ë§Œ ì €ì¥
  - 1ì‹œê°„ TTL

API:
  - CDN ìºì‹œ (Cloudflare)
  - 5ë¶„ TTL
```

### 3. ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…
```yaml
Vite ìë™ ì²˜ë¦¬:
  - Route-based splitting
  - Component lazy loading
  - Dynamic imports
```

---

## ğŸš€ ë°°í¬ ì „ëµ

### CI/CD íŒŒì´í”„ë¼ì¸ (GitHub Actions)

```yaml
# .github/workflows/deploy.yml
name: Deploy

on:
  push:
    branches:
      - main        # ìš´ì˜ ë°°í¬
      - develop     # ê°œë°œ ë°°í¬

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      # 1. ì½”ë“œ ì²´í¬ì•„ì›ƒ
      - uses: actions/checkout@v3
      
      # 2. Node.js ì„¤ì •
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      
      # 3. Admin ë¹Œë“œ
      - name: Build Admin
        run: |
          cd admin
          npm ci
          npm run build
      
      # 4. Frontend ë¹Œë“œ
      - name: Build Frontend
        run: |
          cd frontend
          npm ci
          npm run build
      
      # 5. Vercel ë°°í¬
      - name: Deploy to Vercel
        run: |
          vercel --prod --token=${{ secrets.VERCEL_TOKEN }}
      
      # 6. Firebase Functions ë°°í¬
      - name: Deploy Functions
        run: |
          cd functions
          npm ci
          firebase deploy --only functions --token=${{ secrets.FIREBASE_TOKEN }}
```

### í™˜ê²½ ë¶„ë¦¬

```yaml
ê°œë°œ í™˜ê²½ (develop ë¸Œëœì¹˜):
  URL: https://dev.tworld-store.com
  Firebase: ë™ì¼ í”„ë¡œì íŠ¸ (í™˜ê²½ ë¶„ë¦¬ ì•ˆ í•¨)
  ë°ì´í„°: ìš´ì˜ Sheets (í…ŒìŠ¤íŠ¸ ì‹œíŠ¸ ì‚¬ìš©)

ìš´ì˜ í™˜ê²½ (main ë¸Œëœì¹˜):
  URL: https://tworld-store.com
  Firebase: ë™ì¼ í”„ë¡œì íŠ¸
  ë°ì´í„°: ìš´ì˜ Sheets
```

> Firebase í”„ë¡œì íŠ¸ëŠ” 1ê°œë§Œ ì‚¬ìš© (í™˜ê²½ë³„ ë¶„ë¦¬ ë¶ˆí•„ìš”)

---

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### Google Analytics 4
```javascript
// í˜ì´ì§€ë·°
gtag('config', 'G-XXXXXXXXX', {
  page_path: window.location.pathname
});

// ìƒí’ˆ í´ë¦­
gtag('event', 'select_item', {
  items: [{
    item_id: deviceId,
    item_name: device.model,
    item_brand: device.brand,
    price: device.price
  }]
});

// ìƒë‹´ ì‹ ì²­ (ì „í™˜)
gtag('event', 'purchase', {
  transaction_id: consultationId,
  value: device.price,
  currency: 'KRW'
});
```

### Firebase Functions ë¡œê¹…
```typescript
import * as functions from 'firebase-functions';

// êµ¬ì¡°í™”ëœ ë¡œê·¸
functions.logger.info('ìƒí’ˆ ë™ê¸°í™” ì‹œì‘', {
  sheetsId: SHEETS_ID,
  timestamp: new Date().toISOString()
});

functions.logger.error('API ì˜¤ë¥˜ ë°œìƒ', {
  error: error.message,
  endpoint: '/api/products/list'
});
```

---

## ğŸ”§ ê°œë°œ í™˜ê²½ ì„¤ì •

### ë¡œì»¬ ê°œë°œ ì„œë²„ ì‹¤í–‰

```bash
# 1. Admin ê°œë°œ ì„œë²„
cd admin
npm install
npm run dev
# â†’ http://localhost:5173

# 2. Frontend ê°œë°œ ì„œë²„
cd frontend
npm install
npm run dev
# â†’ http://localhost:5174

# 3. Firebase Functions (ì—ë®¬ë ˆì´í„°)
cd functions
npm install
firebase emulators:start
# â†’ http://localhost:5001
```

### VS Code ì„¤ì • (.vscode/settings.json)
```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.tsdk": "node_modules/typescript/lib",
  "files.associations": {
    "*.css": "tailwindcss"
  }
}
```

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- [í´ë” êµ¬ì¡° ë° íŒŒì¼ ëª©ë¡](./02_í´ë”êµ¬ì¡°_ë°_íŒŒì¼ëª©ë¡.md)
- [íƒ€ì… ì •ì˜](./03_íƒ€ì…ì •ì˜.md)
- [API ëª…ì„¸](./04_APIëª…ì„¸.md)

---

**ë¬¸ì„œ ë²„ì „**: v1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-06
